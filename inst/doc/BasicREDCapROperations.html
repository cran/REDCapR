<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Basic REDCapR Operations</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Basic REDCapR Operations</h1>



<p>This vignette covers the the basic functions exposed by the <a href="https://github.com/r-lib/httr">httr</a> and <a href="https://cran.r-project.org/package=curl">curl</a> packages which
allow you to interact with <a href="https://projectredcap.org/">REDCap</a> through its API.</p>
<div id="reading-redcap-data" class="section level1">
<h1>Reading REDCap Data</h1>
<p>The functions <a href="https://ouhscbbmc.github.io/REDCapR/reference/redcap_read.html"><code>redcap_read()</code></a>
and <a href="https://ouhscbbmc.github.io/REDCapR/reference/redcap_read_oneshot.html"><code>redcap_read_oneshot()</code></a>
use the <a href="https://cran.r-project.org/package=httr">httr</a>
package to call the REDCap API.</p>
<pre><code>## Loading required namespace: kableExtra</code></pre>
<div id="set-project-wide-values" class="section level2">
<h2>Set project-wide values</h2>
<p>There is some information that is specific to the REDCap project, as
opposed to an individual operation. This includes the (1) uri of the
server, and the (2) token for the user’s project.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(REDCapR) <span class="co"># Load the package into the current R session.</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>uri   <span class="ot">&lt;-</span> <span class="st">&quot;https://redcap-dev-2.ouhsc.edu/redcap/api/&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="st">&quot;9A068C425B1341D69E83064A2D273A70&quot;</span> <span class="co"># simple</span></span></code></pre></div>
</div>
<div id="read-all-records-and-fields" class="section level2">
<h2>Read all records and fields</h2>
<p>If no information is passed about the desired records or fields, then
the entire data set is returned. Only two parameters are required,
<code>redcap_uri</code> and <code>token</code>. Unless the
<code>verbose</code> parameter is set to <code>FALSE</code>, a message
will be printed on the R console with the number of records and fields
returned.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Return all records and all variables.</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ds_all_rows_all_fields <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(<span class="at">redcap_uri =</span> uri, <span class="at">token =</span> token)<span class="sc">$</span>data</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>ds_all_rows_all_fields <span class="co"># Inspect the returned dataset</span></span></code></pre></div>
</div>
<div id="read-a-subset-of-the-records" class="section level2">
<h2>Read a subset of the records</h2>
<p>If only a subset of the <strong>records</strong> is desired, the two
approaches are shown below. The first is to pass an array (where each
element is an ID) to the <code>records</code> parameter. The second is
to pass a single string (where the elements are separated by commas) to
the <code>records_collapsed</code> parameter.</p>
<p>The first format is more natural for more R users. The second format
is what is expected by the REDCap API. If a value for
<code>records</code> is specified, but <code>records_collapsed</code> is
not specified, then <code>redcap_read_oneshot</code> automatically
converts the array into the format needed by the API.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Return only records with IDs of 1 and 3</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>desired_records <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>ds_some_rows_v1 <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">redcap_uri =</span> uri,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">token      =</span> token,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">records    =</span> desired_records</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>)<span class="sc">$</span>data</span></code></pre></div>
</div>
<div id="read-a-subset-of-the-fields" class="section level2">
<h2>Read a subset of the fields</h2>
<p>If only a subset of the <strong>fields</strong> is desired, then two
approaches exist. The first is to pass an array (where each element is
an field) to the <code>fields</code> parameter. The second is to pass a
single string (where the elements are separated by commas) to the
<code>fields_collapsed</code> parameter. Like with <code>records</code>
and <code>records_collapsed</code> described above, this function
converts the more natural format (<em>i.e.</em>, <code>fields</code>) to
the format required by the API (<em>i.e.</em>,
<code>fields_collapsed</code>) if <code>fields</code> is specified and
<code>fields_collapsed</code> is not.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Return only the fields record_id, name_first, and age</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>desired_fields <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;record_id&quot;</span>, <span class="st">&quot;name_first&quot;</span>, <span class="st">&quot;age&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>ds_some_fields <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">redcap_uri =</span> uri,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">token      =</span> token,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">fields     =</span> desired_fields</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>)<span class="sc">$</span>data</span></code></pre></div>
</div>
<div id="read-a-subset-of-records-conditioned-on-the-values-in-some-variables" class="section level2">
<h2>Read a subset of records, conditioned on the values in some
variables</h2>
<p>The two techniques above can be combined when your datasets are large
and you don’t want to pull records with certain values. Suppose you want
to select subjects from the previous dataset <em>if</em> the were born
before 1960 and their weight was over 70kg. Two calls to the server are
required. The <strong>first call</strong> to REDCap pulls all the
records, but for only three columns: <code>record_id</code>,
<code>dob</code>, and <code>weight</code>. From this subset, identify
the records that you want to pull all the data for; in this case, the
desired <code>record_id</code> values are <code>3</code> &amp;
<code>5</code>. The <strong>second call</strong> to REDCap pulls all the
columns, but only for the identified records.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="do">## Step 1: First call to REDCap</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>desired_fields_v3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;record_id&quot;</span>, <span class="st">&quot;dob&quot;</span>, <span class="st">&quot;weight&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>ds_some_fields_v3 <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">redcap_uri =</span> uri,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="at">token      =</span> token,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="at">fields     =</span> desired_fields_v3</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>)<span class="sc">$</span>data</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>ds_some_fields_v3 <span class="co">#Examine the these three variables.</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="do">## Step 2: identify desired records, based on age &amp; weight</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>before_1960 <span class="ot">&lt;-</span> (ds_some_fields_v3<span class="sc">$</span>dob <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;1960-01-01&quot;</span>))</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>heavier_than_70_kg <span class="ot">&lt;-</span> (ds_some_fields_v3<span class="sc">$</span>weight <span class="sc">&gt;</span> <span class="dv">70</span>)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>desired_records_v3 <span class="ot">&lt;-</span> ds_some_fields_v3[before_1960 <span class="sc">&amp;</span> heavier_than_70_kg, ]<span class="sc">$</span>record_id</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>desired_records_v3 <span class="co">#Peek at IDs of the identified records</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="do">######</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="do">## Step 3: second call to REDCap</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#Return only records that met the age &amp; weight criteria.</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>ds_some_rows_v3 <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  <span class="at">redcap_uri =</span> uri,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  <span class="at">token      =</span> token,</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  <span class="at">records    =</span> desired_records_v3</span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>)<span class="sc">$</span>data</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>ds_some_rows_v3 <span class="co">#Examine the results.</span></span></code></pre></div>
</div>
<div id="additional-returned-information" class="section level2">
<h2>Additional Returned Information</h2>
<p>The examples above have shown only the resulting data frame, by
specifying <code>$data</code> at the end of the call. However, more is
available to those wanting additional information, such as:</p>
<ol style="list-style-type: decimal">
<li>The <code>data</code> object has the data frame, as in the previous
examples.</li>
<li>The <code>success</code> boolean value indicates if
<code>redcap_read_oneshot</code> believes the operation completed as
intended.</li>
<li>The <code>status_codes</code> is a collection of <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http
status codes</a>, separated by semicolons. There is one code for each
batch attempted.</li>
<li>The <code>outcome_messages</code>: A collection of human readable
strings indicating the operations’ semicolons. There is one code for
each batch attempted. In an unsuccessful operation, it should contain
diagnostic information.</li>
<li>The <code>records_collapsed</code> field passed to the API. This
shows which record subsets, if any, were requested.</li>
<li>The <code>fields_collapsed</code> fields passed to the API. This
shows which field subsets, if any, were requested.</li>
<li>The <code>elapsed_seconds</code> measures the duration of the
call.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#Return only the fields record_id, name_first, and age</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>all_information <span class="ot">&lt;-</span> <span class="fu">redcap_read</span>(</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">redcap_uri =</span> uri,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">token      =</span> token,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="at">fields     =</span> desired_fields</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>all_information <span class="co">#Inspect the additional information</span></span></code></pre></div>
</div>
</div>
<div id="session-information" class="section level1">
<h1>Session Information</h1>
<p>For the sake of documentation and reproducibility, the current report
was rendered in the following environment. Click the line below to
expand.</p>
<details>
<summary>
Environment <span class="glyphicon glyphicon-plus-sign"></span>
</summary>
</details>
<p>Report rendered by wibeasley at 2025-07-27, 18:05 -0500 in -999
seconds.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
